\label{xmark-queries-couchbase}
\begin{enumerate}[label=Q\arabic*.]
	\item %1
	\begin{lstlisting}[language=JSON]
			function (doc, meta) {
			   if(doc.doctype && doc.doctype=="people" && doc.id=="person0"){
				emit(doc.name);	   
			    }
			  
			}
		\end{lstlisting}

	\item %2
	\begin{lstlisting}[language=JSON]
	function (doc, meta) {
	   if(doc.doctype && doc.doctype=="open_auctions"){
	     if(doc.bidder){
	     	var first = doc.bidder[0];
	       for(var i=0; i<first.length;i++) {
	         if(first[i].increase) {
	           var increase = first[i].increase;
	           //emit(doc.id,increase)
	           emit("increase",increase)
	           break;
	         }
	       }
	     } else {
	     	      emit("increase",null)
	     }
	   }
	}
	\end{lstlisting}
	
    \item %3
	\begin{lstlisting}[language=JSON]
	  function (doc, meta) {
	     if(doc.doctype && doc.doctype=="open_auctions"){
	       if(doc.bidder){
	       	var first = doc.bidder[0];
	         	var last = doc.bidder[(doc.bidder.length - 1)];
	          var increaseFirst = 0;
	          var increaseLast = 0;
	         
	         for(var i=0; i<first.length;i++) {
	           if(first[i].increase) {
	             increaseFirst = first[i].increase;
	             //emit(doc.id,increase)
	             break;
	           }
	         }
	         
	         for(var i=0; i<last.length;i++) {
	           if(last[i].increase) {
	             increaseLast = last[i].increase;
	             //emit(doc.id,increase)
	             break;
	           }
	         }
	         if(increaseFirst && increaseLast) {
	           if(increaseFirst * 2 <= increaseLast ){
	  	   emit("increase",{first:increaseFirst,last:increaseLast,id:doc.id});
	           }
	         }
	         
	       } else {
	       	     // emit("increase",null)
	       }
	     }
	  }
	\end{lstlisting}
	
	
    \item %4
	\begin{lstlisting}[language=JSON]
	   []
	\end{lstlisting}
	
	
    \item %5
	\begin{lstlisting}[language=JSON]
	map:
	   function (doc, meta) {
	      if(doc.doctype && doc.doctype=="closed_auctions"){
	        if(doc.price){
	          if(doc.price >= 40) {
	          emit(doc.id,doc.price)
	        	}
	       }
	      }
	   }
	  reduce: 
	    _count
	\end{lstlisting}
	
    \item %6
	\begin{lstlisting}[language=JSON]
	  map:
	  function (doc, meta) {
	     if(doc.doctype && doc.doctype=="regions"){
	      
	         emit(doc.id,null)
	      
	     }
	  }
	  
	  reduce: 
	  _count
	\end{lstlisting}
	
	
    \item %7
	\begin{lstlisting}[language=JSON]
	   []
	\end{lstlisting}
	
	
    \item %8
	\begin{lstlisting}[language=JSON]
	[]
	\end{lstlisting}
	
	
    \item %9
	\begin{lstlisting}[language=JSON]
	   []
	\end{lstlisting}
	
	
    \item %10
	\begin{lstlisting}[language=JSON]
	   []
	\end{lstlisting}
	
	
    \item %11
	\begin{lstlisting}[language=JSON]
		[]
	\end{lstlisting}
	
	
    \item %12
	\begin{lstlisting}[language=JSON]
	   []
	\end{lstlisting}
	
	
    \item %13
	\begin{lstlisting}[language=JSON]
	   function (doc, meta) {
	     if(doc.doctype && doc.doctype == "regions" && doc.regions && doc.regions=="australia"){
	       if(doc.description){
	         emit("item",{name:doc.name, description:doc.description})
	       
	       }
	     }
	   }
	\end{lstlisting}
	
    \item %14
	\begin{lstlisting}[language=JSON]
		//don't supprt full text search
	 	function (doc, meta) {
	 	  if(doc.doctype && doc.doctype=="regions"){
	 	   
	 	    if(doc.description){
	 	       var desc = JSON.stringify(doc.description);
	 	      if(desc.indexOf("gold") !== -1)
	 	       emit(meta.id, doc.name);
	 	   }
	 	  }
	 	}
	\end{lstlisting}	

    \item %15
	\begin{lstlisting}[language=JSON]
	 function (doc, meta) {
	   if(doc.doctype=="closed_auctions"){
	     var p1 = doc.annotation.description.parlist;
	     if(p1){
	       for(var i=0;i<p1.length;i++){
	       	var p2 = p1[i].listitem.parlist;
	         if(p2) {
	           for(var j=0;j<p2.length;j++){
	             
	             if(p2[j].listitem && p2[j].listitem.text && p2[j].listitem.text.emph && p2[j].listitem.text.emph.keyword){
	             	var keyword = p2[j].listitem.text.emph.keyword;
	               emit("text", keyword);   
	             }
	           }
	         }
	       }
	     }
	   }
	 }
	\end{lstlisting}	

    \item %16
	\begin{lstlisting}[language=JSON]
	 function (doc, meta) {
	   if(doc.doctype=="closed_auctions"){
	     var p1 = doc.annotation.description.parlist;
	     if(p1){
	       var person = (doc.seller.person)?doc.seller.person:0;
	       for(var i=0;i<p1.length;i++){
	       	var p2 = p1[i].listitem.parlist;
	         if(p2) {
	           for(var j=0;j<p2.length;j++){
	             
	             if(p2[j].listitem && p2[j].listitem.text && p2[j].listitem.text.emph && p2[j].listitem.text.emph.keyword){
	             	var keyword = p2[j].listitem.text.emph.keyword;
	               if(person){
	               	emit("person", {id:person});     
	               }
	               
	             }
	           }
	         }
	       }
	     }
	   }
	 }
	\end{lstlisting}	

    
    \item %17
	\begin{lstlisting}[language=JSON]
	  function (doc, meta) {
	    if(doc.doctype=="people"){
	      if(!doc.homepage && doc.name){
	        emit("name",doc.name)
	      } 
	    }
	  }
	\end{lstlisting}	

    \item %18
	\begin{lstlisting}[language=JSON]
	  function (doc, meta) {
	    if(doc.doctype=="open_auctions"){
	      
	      if(doc.reserve){
	      	var exchange = parseFloat(doc.reserve) * 2.20371;
	        
	        emit(null,exchange)
	      } 
	    }
	  }
	\end{lstlisting}	

    \item %19
	\begin{lstlisting}[language=JSON]
	  function (doc, meta) {
	    if(doc.doctype=="regions" && doc.name){
	      var location = (doc.location)?doc.location:"";
	      emit(location,{item:{name:doc.name,location:location}});
	    }
	  }
	  })
	\end{lstlisting}	
    \item %20
	\begin{lstlisting}[language=JSON]
	  map:
	  function (doc, meta) {
	    if(doc.doctype=="people"){
	   
	      var income = (doc.profile && doc.profile.income)? doc.profile.income : 0;
	  
	       if(income >= 100000 ){
	    	 emit("preferred",1);
	      }else if(income < 100000 && 
	               income >= 30000) {
	        emit("standard",1);
	      }else if(income < 30000 &&
	           income > 0 ){
	       
	        emit("challenge",1);
	      } else {
	       emit("na",income);
	      }
	    }
	  }
	  
	  reduce:
	  _count
	\end{lstlisting}

\end{enumerate}
